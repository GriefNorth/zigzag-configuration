---
- name: permit empty passwords in pam
  command: pam-config -a --nullok

- name: make sure liveuser has empty password
  command: passwd -d liveuser

- name: disable polkit password prompt for liveuser
  copy:
    src: "10-liveuser.rules"
    dest: /etc/polkit-1/rules.d/
    owner: polkitd
    group: polkitd

- name: enable autologin for liveuser
  lineinfile:
    path: /etc/sysconfig/displaymanager
    regexp: '^DISPLAYMANAGER_AUTOLOGIN='
    line: 'DISPLAYMANAGER_AUTOLOGIN="liveuser"'

- name: refresh repositories to gather appstream data
  zypper_repository: name='*' runrefresh=yes
